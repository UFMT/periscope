<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="/template/templateProject.xhtml">

	<ui:define name="content">
		<ui:include src="/template/flashmessages.xhtml" />		
		<center>
			<p:dataTable id="users" var="user"
				emptyMessage="Não Existem usuário cadastrados"
				value="#{userController.users}" paginator="true"
				paginatorAlwaysVisible="false" paginatorPosition="bottom" rows="10"
				rowKey="#{user.title}">

				<p:columnGroup type="header">
					<p:row>
						<p:column rowspan="2" headerText="Nome" />
						<p:column rowspan="2" headerText="Email" />
						<p:column rowspan="2" headerText="Nível de Acesso" />
						<p:column rowspan="2" headerText="Ações" />
					</p:row>
				</p:columnGroup>
				<p:column>
					<center>#{user}</center>
				</p:column>
				<p:column width="300">														
						#{user.email}						
				</p:column>
				<p:column>
					<center>
						<span
							class="label label-#{user.userLevel.accessLevel >= 10 ? 'important' : 'success'}">
							#{user.userLevel} </span>
					</center>
				</p:column>
				<p:column>
					<center>
						<h:form style="margin-bottom:0px">
							<h:commandLink value="Editar" action="editUser" rendered="#{currentUser.userLevel.accessLevel == 10 or currentUser.id.toString() == user.id.toString()}"
								style="color:white;margin-right: 10px" class="btn btn-inverse">
								<f:param name="userId" value="#{user.id.toString()}"/>	
							</h:commandLink>
							<h:commandLink value="Deletar" style="color:white" rendered="#{currentUser.userLevel.accessLevel == 10 and currentUser.id.toString() != user.id.toString()}"
								onclick="if(!confirm('Deseja excluir este usuario ?')) { return false; }"
								class="btn btn-inverse" action="#{userController.delete(user.id.toString())}"/>
						</h:form>
					</center>
				</p:column>
			</p:dataTable>
			<br />
			<h:form>
				<h:commandLink value="Novo Usuário" style="color:white"
					class="btn btn-large btn-info" action="newUser"/>
			</h:form>			

		</center>
	</ui:define>

</ui:composition>
</html>
